!function(){define("modules/objects/snake",[],function(){var e,t,i=3,n=1,o=37,s=39,r=38,c=40,l=2,a=3,h=4,u=5;return{cols:0,rows:0,tileSize:0,gameOver:!1,pts:0,godMode:!0,init:function(i,n,o){this.gameOver=!1,this.godMode=!1,t=s,e=[],this.pts=0,this.cols=i,this.rows=n,this.tileSize=o,this.initElements(i,n),this.initEvents()},getId:function(){return n},getElements:function(){return e},printItem:function(e,t){e.fillStyle=this.godMode?"blue":"green",e.fillRect(t.x*this.tileSize,t.y*this.tileSize,this.tileSize,this.tileSize)},initElements:function(t,n){for(var o=Math.floor(t/2),s=Math.floor(n/2),r=0;i>r;r++)e.push(this.getElement(o+r,s))},getElement:function(e,t){return{x:e,y:t,id:n}},getLength:function(){return e.length},initEvents:function(){document.addEventListener("keyup",function(e){if(!this.lock)switch(!0){case Boolean(e.keyCode===r&&t!==c):case Boolean(e.keyCode===c&&t!==r):case Boolean(e.keyCode===o&&t!==s):case Boolean(e.keyCode===s&&t!==o):this.lock=!0,t=e.keyCode}}.bind(this))},move:function(){var i=e.shift(),n=e[e.length-1];switch(t){case r:i.y=n.y-1,i.x=n.x;break;case c:i.y=n.y+1,i.x=n.x;break;case o:i.y=n.y,i.x=n.x-1;break;case s:i.y=n.y,i.x=n.x+1}this.gameOver=this.isOverboard(i)||this.isBitten(i),this.lock=!1,e.push(i)},increase:function(i){var n=this.getElement(e[0].x,e[0].y);switch(t){case r:n.y+=1;break;case c:n.y-=1;break;case o:n.x+=1;break;case s:n.x-=1}e.unshift(n),this.pts+=i},isOverboard:function(e){return e.x<0||e.x>this.cols-1||e.y<0||e.y>this.rows-1},isBitten:function(t){if(this.godMode)return!1;for(var i=0;i<e.length;i++)if(e[i].x===t.x&&e[i].y===t.y)return!0;return!1},detectCollision:function(t){for(var i,n=e[e.length-1],o=0;o<t.length;o++)if(n.x===t[o].x&&n.y===t[o].y){i=t[o],this.collisionWith(t[o],t);break}return i||null},collisionWith:function(e,t){switch(e.id){case l:case a:case h:this.godMode=!1,this.increase(e.pts||0);break;case u:this.godMode=!0;break;default:this.gameOver=!0,console.log("collision with unknown object -> ",e)}t.indexOf(e)>=0&&t.splice(t.indexOf(e),1)}}})}(),function(){define("modules/objects/food/apple",[],function(){var e=new Image;return e.src="images/apple.png",{id:2,pts:1,img:e,type:"apple"}})}(),function(){define("modules/objects/food/strawberry",[],function(){var e=new Image;return e.src="images/strawberry.png",{id:3,pts:2,img:e,type:"strawberry"}})}(),function(){define("modules/objects/food/mushroom",[],function(){var e=new Image;return e.src="images/mushroom.png",{id:4,pts:-1,img:e,type:"mushroom"}})}(),function(){define("modules/objects/food/elixir",[],function(){var e=new Image;return e.src="images/elixir.png",{id:5,pts:0,img:e,type:"elixir"}})}(),function(){define("modules/objects/food",["modules/objects/food/apple","modules/objects/food/strawberry","modules/objects/food/mushroom","modules/objects/food/elixir"],function(e,t,i,n){var o=[],s={apple:10,strawberry:3,mushroom:5,elixir:1};return{tileSize:0,init:function(e,t,i,n){o=[],this.tileSize=i,this.generateFood(e,t,n)},getId:function(e){return e},getImage:function(o){var s={apple:e,strawberry:t,mushroom:i,elixir:n},r=s[o]||e;return r},printItem:function(e,t){e.drawImage(t.img,t.x*this.tileSize,t.y*this.tileSize,this.tileSize,this.tileSize)},add:function(e,t,i){var n=i.type||"apple";o.push(this.getFood(e,t,n))},generateFood:function(e,t,i){var n;for(var r in s)for(n=0;n<s[r];n++)o.push(this.getFood(e,t,r))},getFood:function(e,t,i){var n=this.getImage(i);return{x:Math.floor(Math.random()*e-1)+1,y:Math.floor(Math.random()*t-1)+1,id:n.id,img:n.img,pts:n.pts,type:n.type||""}},getElements:function(){return o}}})}(),function(){define("modules/objects/menu",[],function(){return{ctx:null,cols:0,rows:0,tileSize:0,width:0,height:0,init:function(e,t,i){this.cols=e,this.rows=t,this.tileSize=i,this.width=this.cols*this.tileSize,this.height=this.rows*this.tileSize},gameOver:function(e,t){var i=this.getBestScore()>t?this.getBestScore():t;e.clearRect(0,0,this.cols*this.tileSize,this.rows*this.tileSize),e.font="bold 20px serif",e.textAlign="center",e.fillText("Game Over",this.width/2,this.height/2-40),e.font="16px serif",e.textAlign="center",e.fillText("press <Enter> to start a new game",this.width/2,this.height/2-20),e.font="16px serif",e.textAlign="center",e.fillText("your score is: "+(t||0),this.width/2,this.height-100),e.font="16px serif",e.textAlign="center",e.fillText("the best score is: "+i,this.width/2,this.height-80),this.setBestScore(i)},getBestScore:function(){return localStorage.getItem("bestScore")||0},setBestScore:function(e){return localStorage.setItem("bestScore",e||0)}}})}(),function(){define("modules/game",["modules/objects/snake","modules/objects/food","modules/objects/menu"],function(e,t,i){var n,o,s,r=20,c=50,l=30,a=15,h=13;return{frame:0,pts:0,init:function(){e.init(c,l,r),t.init(c,l,r,a),i.init(c,l,r),this.boardInit(c,l,r),this.initEvents(),this.gameLoop(),this.render()},boardInit:function(e,t,i){n=document.getElementById("container"),n.innerHTML="",o=document.createElement("canvas"),o.width=(e||40)*(i||10),o.height=(t||30)*(i||10),n.appendChild(o),s=o.getContext("2d")},initEvents:function(){document.addEventListener("keyup",function(t){switch(t.keyCode){case h:e.gameOver&&this.init()}}.bind(this))},printGrid:function(e,t,i){for(var n=1;t>n;n++)s.beginPath(),s.moveTo(0,i*n),s.lineWidth=.05,s.lineTo(e*i,i*n),s.closePath(),s.stroke();for(var o=1;e>o;o++)s.beginPath(),s.moveTo(i*o,0),s.lineWidth=.05,s.lineTo(i*o,t*i),s.closePath(),s.stroke()},printItem:function(i,n){switch(i.id){case e.getId():e.printItem(s,i);break;case t.getId(i.id):t.printItem(s,i);break;default:s.fillStyle="grey",s.fillRect(i.x*n,i.y*n,n,n)}},printPoints:function(){s.fillStyle="grey",s.font="10px sans-serif",s.textAlign="right",s.fillText("score: "+e.pts,c*r-5,15)},render:function(){var i=e.getElements(),n=t.getElements(),o=n.concat(i),a=e.detectCollision(n);s.clearRect(0,0,c*r,l*r),a&&t.add(c,l,a),this.printGrid(c,l,r);for(var h=0;h<o.length;h++)this.printItem(o[h],r);this.printPoints()},gameLoop:function(){var t=setInterval(function(){e.gameOver?(clearInterval(t),i.gameOver(s,e.pts)):(e.move(),this.render())}.bind(this),100)}}})}(),function(){var e=.02;requirejs.config({urlArgs:"v="+e}),define("application",["modules/game"],function(e){e.init()})}();
//# sourceMappingURL=application.js.map